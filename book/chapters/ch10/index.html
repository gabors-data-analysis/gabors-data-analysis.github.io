<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Chapter 10: Multiple Linear Regression</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="index_files/libs/clipboard/clipboard.min.js"></script>
<script src="index_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="index_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="index_files/libs/quarto-html/popper.min.js"></script>
<script src="index_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="index_files/libs/quarto-html/anchor.min.js"></script>
<link href="index_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="index_files/libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="index_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="index_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="index_files/libs/bootstrap/bootstrap-bb462d781dde1847d9e3ccf7736099dd.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Chapter 10: Multiple Linear Regression</h1>
<p class="subtitle lead">Understanding associations while controlling for multiple factors</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><link href="https://fonts.googleapis.com/css2?family=Anton&amp;family=Oswald:wght@300;400;500;600;700&amp;family=Roboto+Condensed:wght@300;400;700&amp;family=Lora:wght@400;600&amp;display=swap" rel="stylesheet"></p>
<section id="chapter-10-multiple-linear-regression" class="level1 chapter-title">
<h1 class="chapter-title">Chapter 10: Multiple Linear Regression</h1>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
✅ Chapter Status: COMPLETE
</div>
</div>
<div class="callout-body-container callout-body">
<p>All 4 pages (Sections 10.1-10.12) with 6 case studies are now available! This is the first complete chapter in the interactive HTML edition.</p>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Chapter Motivation
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Gender wage gaps.</strong> There is a substantial difference in the average earnings of women and men in all countries. You want to understand more about the potential origins of that difference, focusing on employees with a graduate degree. You have data on a large sample of employees with their earnings and characteristics like age and degree type. <strong>How can you uncover gender differences that are not due to differences in these other characteristics?</strong></p>
<p><strong>Finding hotel deals.</strong> You’ve analyzed hotel prices in a city to find hotels that are underpriced relative to their distance from the city center. But hotels also differ in quality features related to price. <strong>How can you find hotels that are underpriced relative to all their features?</strong></p>
</div>
</div>
<hr>
<section id="what-youll-learn" class="level2">
<h2 class="anchored" data-anchor-id="what-youll-learn">What You’ll Learn</h2>
<p>This chapter introduces <strong>multiple linear regression</strong> – the most widely used method to uncover patterns of associations between variables. You’ll learn:</p>
<ul>
<li>Why and when to use multiple regression</li>
<li>How to interpret coefficients in the presence of multiple explanatory variables</li>
<li>The concept of <strong>omitted variable bias</strong> and why it matters</li>
<li>Statistical inference with multiple regression</li>
<li>How to include categorical variables and interactions</li>
<li>Applications to causal analysis and prediction</li>
</ul>
<hr>
</section>
<section id="chapter-structure" class="level2">
<h2 class="anchored" data-anchor-id="chapter-structure">📖 Chapter Structure</h2>
<p>This chapter is organized into <strong>4 pages</strong> for optimal learning, with <strong>6 case studies</strong> using real data:</p>
<section id="page-1-foundation" class="level3">
<h3 class="anchored" data-anchor-id="page-1-foundation"><a href="01-foundation.html">Page 1: Foundation →</a> ✅</h3>
<p><strong>Sections 10.1-10.3</strong> - Why and when to use multiple regression (Section 10.1) - Multiple linear regression with two explanatory variables (Section 10.2) - Multiple regression and simple regression: Omitted variable bias (Section 10.3)</p>
<p><strong>Case Study A1:</strong> Understanding the Gender Difference in Earnings<br>
<em>Multiple linear regression</em></p>
<p><strong>What you’ll master:</strong> Core concepts of multiple regression and why controlling for other variables matters</p>
<hr>
</section>
<section id="page-2-statistical-inference" class="level3">
<h3 class="anchored" data-anchor-id="page-2-statistical-inference"><a href="02-inference.html">Page 2: Statistical Inference →</a> ✅</h3>
<p><strong>Sections 10.4-10.6</strong> - Multiple linear regression terminology (Section 10.4) - Standard errors and confidence intervals (Section 10.5) - Hypothesis testing in multiple linear regression (Section 10.6)</p>
<p><strong>Case Study A2:</strong> Understanding the Gender Difference in Earnings<br>
<em>Statistical inference</em></p>
<p><strong>What you’ll master:</strong> Statistical inference in multiple regression and interpreting uncertainty</p>
<hr>
</section>
<section id="page-3-extensions" class="level3">
<h3 class="anchored" data-anchor-id="page-3-extensions"><a href="03-extensions.html">Page 3: Extensions →</a> ✅</h3>
<p><strong>Sections 10.7-10.8</strong> - Multiple linear regression with three or more explanatory variables (Section 10.7) - Nonlinear patterns and multiple linear regression (Section 10.8)</p>
<p><strong>Case Study A3:</strong> Understanding the Gender Difference in Earnings<br>
<em>Nonlinear patterns and multiple linear regression</em></p>
<p><strong>What you’ll master:</strong> Working with many variables and capturing nonlinear relationships</p>
<hr>
</section>
<section id="page-4-applications" class="level3">
<h3 class="anchored" data-anchor-id="page-4-applications"><a href="04-applications.html">Page 4: Applications →</a> ✅</h3>
<p><strong>Sections 10.9-10.12</strong> - Qualitative right-hand-side variables (Section 10.9) - Interactions: Different slopes across groups (Section 10.10) - Multiple regression and causal analysis (Section 10.11) - Multiple regression and prediction (Section 10.12)</p>
<p><strong>Case Studies:</strong> - <strong>A4:</strong> Gender Earnings - Qualitative variables - <strong>A5:</strong> Gender Earnings - Interactions - <strong>A6:</strong> Gender Earnings - Causal interpretation - <strong>B1:</strong> Hotel Prices - Prediction with multiple regression</p>
<p><strong>What you’ll master:</strong> Categorical variables, interactions, and applying multiple regression to causal questions and prediction</p>
<hr>
</section>
</section>
<section id="learning-objectives" class="level2">
<h2 class="anchored" data-anchor-id="learning-objectives">🎯 Learning Objectives</h2>
<p>By the end of this chapter, you will be able to:</p>
<ol type="1">
<li>✅ Identify questions best answered with multiple regression from available data</li>
<li>✅ Estimate multiple linear regression coefficients and present and interpret them</li>
<li>✅ Estimate appropriate standard errors, create confidence intervals and test coefficients</li>
<li>✅ Select variables to include in a multiple regression guided by the purpose of analysis</li>
<li>✅ Understand the relationship between multiple regression results and causal effects</li>
<li>✅ Use multiple regression for prediction and residual analysis</li>
<li>✅ Include categorical variables using dummy variables</li>
<li>✅ Use interaction terms to allow different relationships across groups</li>
</ol>
<hr>
</section>
<section id="case-studies" class="level2">
<h2 class="anchored" data-anchor-id="case-studies">📊 Case Studies</h2>
<p>This chapter includes <strong>6 case studies</strong> using real data, distributed across the 4 pages:</p>
<section id="case-studies-a1-a6-gender-earnings-gap" class="level3">
<h3 class="anchored" data-anchor-id="case-studies-a1-a6-gender-earnings-gap">Case Studies A1-A6: Gender Earnings Gap</h3>
<p>📂 <a href="https://github.com/gabors-data-analysis/da_case_studies/tree/master/ch10-gender-earnings-understand">Code Repository</a></p>
<ul>
<li><strong>Data:</strong> Current Population Survey (CPS), USA, 2014</li>
<li><strong>Sample:</strong> 18,241 employees with graduate degrees (ages 24-65)</li>
<li><strong>Question:</strong> Understanding the gender wage gap</li>
</ul>
<p><strong>The six case studies progressively build understanding:</strong> - <strong>A1 (Page 1):</strong> Basic multiple regression with age - <strong>A2 (Page 2):</strong> Statistical inference on coefficients - <strong>A3 (Page 3):</strong> Nonlinear age patterns - <strong>A4 (Page 4):</strong> Education categories - <strong>A5 (Page 4):</strong> Gender × age interactions - <strong>A6 (Page 4):</strong> Causal interpretation and many covariates</p>
</section>
<section id="case-study-b1-hotel-prices" class="level3">
<h3 class="anchored" data-anchor-id="case-study-b1-hotel-prices">Case Study B1: Hotel Prices</h3>
<p>📂 <a href="https://github.com/gabors-data-analysis/da_case_studies/tree/master/ch10-hotels-multiple-reg">Code Repository</a></p>
<ul>
<li><strong>Data:</strong> ~217 hotels in Vienna, November 2017</li>
<li><strong>Sample:</strong> Hotels with 3-4 stars within 8 miles of city center</li>
<li><strong>Question:</strong> Finding underpriced hotels using multiple features</li>
<li><strong>Location:</strong> Page 4</li>
</ul>
<hr>
</section>
</section>
<section id="code-data" class="level2">
<h2 class="anchored" data-anchor-id="code-data">💻 Code &amp; Data</h2>
<p>All case studies include: - <strong>R Code:</strong> Complete, reproducible analysis with tidyverse - <strong>Python Code:</strong> Python equivalents<br>
- <strong>Stata Code:</strong> For regression-focused analyses - <strong>Datasets:</strong> Cleaned and ready to use - <strong>Codespaces:</strong> One-click cloud coding environment</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
🚀 Quick Start with Code
</div>
</div>
<div class="callout-body-container callout-body">
<p>Click any “Open in Codespace” button to: 1. Launch a pre-configured coding environment in your browser 2. Run all analyses without installing anything 3. Modify code and experiment with the data 4. See exactly how tables and figures were created</p>
<p>No setup required – just click and code!</p>
</div>
</div>
<hr>
</section>
<section id="ai-practice-tasks" class="level2">
<h2 class="anchored" data-anchor-id="ai-practice-tasks">🤖 AI Practice Tasks</h2>
<p>Each page includes <strong>interactive AI practice tasks</strong> where you can: - Copy prompts to use with Claude or other AI assistants - Get personalized explanations of concepts - Generate practice problems tailored to your learning - Check your understanding with worked examples</p>
<p><strong>How to use:</strong> 1. Click “📋 Copy &amp; Open in Claude” on any AI task 2. Paste the prompt into Claude.ai (or your preferred AI) 3. Work through the explanation or problem 4. Return to the textbook to continue learning</p>
<hr>
</section>
<section id="time-estimates" class="level2">
<h2 class="anchored" data-anchor-id="time-estimates">⏱️ Time Estimates</h2>
<ul>
<li><strong>Quick overview:</strong> 2-3 hours (read all pages, skim examples)</li>
<li><strong>Deep learning:</strong> 6-8 hours (work through all examples and AI tasks)</li>
<li><strong>With hands-on coding:</strong> 10-12 hours (replicate all analyses)</li>
<li><strong>Complete mastery:</strong> 15+ hours (coding + practice problems + extensions)</li>
</ul>
<p><strong>Recommended pace:</strong> 1-2 pages per study session</p>
<hr>
</section>
<section id="navigation-guide" class="level2">
<h2 class="anchored" data-anchor-id="navigation-guide">🗺️ Navigation Guide</h2>
<p><strong>Within this chapter:</strong> - Use the <strong>sidebar</strong> to jump to any page or section - Click <strong>Previous/Next</strong> buttons at the bottom of each page - Return to this index anytime to see the big picture</p>
<p><strong>Chapter context:</strong> - <strong>Previous:</strong> <a href="../ch09/index.html">Chapter 9: Generalizing Results of a Regression</a> - <strong>Next:</strong> <a href="../ch11/index.html">Chapter 11: Modeling Probabilities</a> - <strong>Part:</strong> Part II - Regression Analysis (Chapters 7-12)</p>
<hr>
</section>
<section id="part-ii-regression-analysis-context" class="level2">
<h2 class="anchored" data-anchor-id="part-ii-regression-analysis-context">📚 Part II: Regression Analysis Context</h2>
<p>Chapter 10 is part of the <strong>Regression Analysis</strong> section of the textbook:</p>
<p><strong>Chapter 7:</strong> Simple Regression<br>
<em>Foundation – one explanatory variable</em></p>
<p><strong>Chapter 8:</strong> Complicated Patterns and Messy Data<br>
<em>Nonlinear patterns and robust methods</em></p>
<p><strong>Chapter 9:</strong> Generalizing Results of a Regression<br>
<em>Statistical inference in simple regression</em></p>
<p><strong>→ Chapter 10:</strong> Multiple Linear Regression ✅ <em>You are here</em><br>
<em>Multiple explanatory variables and controlling for covariates</em></p>
<p><strong>Chapter 11:</strong> Modeling Probabilities<br>
<em>Binary outcomes and logistic regression</em></p>
<p><strong>Chapter 12:</strong> Regression with Time Series Data<br>
<em>Temporal patterns and forecasting</em></p>
<hr>
</section>
<section id="prerequisites" class="level2">
<h2 class="anchored" data-anchor-id="prerequisites">📖 Prerequisites</h2>
<p><strong>Required knowledge:</strong> - Chapter 7: Simple Regression (essential) - Chapter 9: Generalizing Regression Results (essential) - Basic statistics: mean, variance, correlation, standard deviation - Understanding of confidence intervals and hypothesis tests</p>
<p><strong>Helpful but not essential:</strong> - Chapter 8: Complicated Patterns (for nonlinear models) - Linear algebra basics (not covered in this book) - Matrix notation (not used in this chapter)</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important Note on Sequence
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Do not skip Chapter 7 and 9!</strong> Multiple regression builds directly on simple regression concepts. Without understanding simple regression, you will struggle with: - What regression coefficients mean - How to interpret standard errors and confidence intervals - The logic of hypothesis testing - The difference between correlation and causation</p>
</div>
</div>
<hr>
</section>
<section id="study-strategies" class="level2">
<h2 class="anchored" data-anchor-id="study-strategies">🎓 Study Strategies</h2>
<section id="for-first-time-learners" class="level3">
<h3 class="anchored" data-anchor-id="for-first-time-learners">For First-Time Learners</h3>
<ol type="1">
<li><strong>Read sequentially</strong> – Don’t skip ahead; concepts build on each other</li>
<li><strong>Pause at examples</strong> – Try to interpret results before reading the interpretation</li>
<li><strong>Use AI tasks actively</strong> – They reinforce learning better than passive reading</li>
<li><strong>Focus on intuition first</strong> – Understand “why” before memorizing formulas</li>
<li><strong>Return to review boxes</strong> – They summarize key concepts</li>
</ol>
</section>
<section id="for-review-or-reference" class="level3">
<h3 class="anchored" data-anchor-id="for-review-or-reference">For Review or Reference</h3>
<ol type="1">
<li><strong>Start with review boxes</strong> – Get the key concepts quickly</li>
<li><strong>Jump to specific sections</strong> – Use the detailed table of contents</li>
<li><strong>Check the glossary</strong> – Quick definitions of all terms</li>
<li><strong>Review case study summaries</strong> – See applications without details</li>
</ol>
</section>
<section id="for-instructors" class="level3">
<h3 class="anchored" data-anchor-id="for-instructors">For Instructors</h3>
<ol type="1">
<li><strong>Assign pages progressively</strong> – 4 natural units for homework/discussion</li>
<li><strong>Use AI tasks as assignments</strong> – Students submit their AI conversations</li>
<li><strong>Focus on case study interpretation</strong> – Better than just running code</li>
<li><strong>Emphasize review boxes</strong> – Core concepts students must master</li>
<li><strong>Page 4 is comprehensive</strong> – May need two class sessions to cover fully</li>
</ol>
<hr>
</section>
</section>
<section id="what-makes-this-chapter-unique" class="level2">
<h2 class="anchored" data-anchor-id="what-makes-this-chapter-unique">📈 What Makes This Chapter Unique</h2>
<p><strong>Compared to other textbooks:</strong></p>
<ol type="1">
<li><strong>Integrated case studies</strong> – Same dataset across 6 studies showing progression</li>
<li><strong>Practical focus</strong> – Always connects theory to real applications</li>
<li><strong>Modern tools</strong> – Robust standard errors, emphasis on interpretation</li>
<li><strong>Honest about causality</strong> – Clear about what regression can and cannot show</li>
<li><strong>Visual learning</strong> – Extensive use of graphs and intuitive explanations</li>
<li><strong>Accessible math</strong> – Formulas included but explained intuitively</li>
</ol>
<hr>
</section>
<section id="key-concepts-preview" class="level2">
<h2 class="anchored" data-anchor-id="key-concepts-preview">🔍 Key Concepts Preview</h2>
<p>By the end of this chapter, you’ll deeply understand:</p>
<p><strong>Core concepts:</strong> - Multiple linear regression equation and interpretation - Conditional vs.&nbsp;unconditional differences - Controlling for covariates - Omitted variable bias</p>
<p><strong>Statistical concepts:</strong> - Standard errors in multiple regression - Confidence intervals and hypothesis tests - F-tests for joint hypotheses - Multicollinearity and its consequences</p>
<p><strong>Practical tools:</strong> - Dummy variables for categories - Interaction terms for different slopes - Nonlinear patterns in multiple regression - Prediction and residual analysis</p>
<p><strong>Big picture:</strong> - When multiple regression helps with causality - When to focus on prediction vs.&nbsp;causal inference - How to select variables for different purposes - Limits of observational data</p>
<hr>
</section>
<section id="ready-to-start" class="level2">
<h2 class="anchored" data-anchor-id="ready-to-start">🎉 Ready to Start?</h2>
<p><strong><a href="01-foundation.html">Begin with Page 1: Foundation →</a></strong></p>
<p>Or explore: - <a href="02-inference.html">Page 2: Statistical Inference →</a> - <a href="03-extensions.html">Page 3: Extensions →</a><br>
- <a href="04-applications.html">Page 4: Applications →</a> - <a href="glossary.html">View Glossary</a> – Quick reference for all terms</p>
<p><strong>Chapter complete!</strong> All 4 pages covering Sections 10.1-10.12 are now available.</p>
<hr>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
💡 Pro Tips for Success
</div>
</div>
<div class="callout-body-container callout-body">
<ol type="1">
<li><strong>Keep a notebook</strong> – Write down key insights and questions</li>
<li><strong>Work through formulas</strong> – Don’t just read them, calculate examples</li>
<li><strong>Compare specifications</strong> – Notice how results change with different models</li>
<li><strong>Think causally</strong> – Always ask “what’s omitted?” when interpreting coefficients</li>
<li><strong>Visualize results</strong> – Draw graphs to understand patterns</li>
<li><strong>Discuss with peers</strong> – Explaining concepts helps you learn</li>
<li><strong>Apply to your data</strong> – Think how methods apply to your research</li>
</ol>
</div>
</div>
<hr>
</section>
<section id="book-information" class="level2" style="text-align: center; margin-top: 3rem; padding: 2rem; background: linear-gradient(135deg, #F7F3E9 0%, white 100%); border-radius: 12px; border: 3px solid #D63384;">
<h2 class="anchored" data-anchor-id="book-information">📚 Book Information</h2>
<p><strong>Full Title:</strong> Data Analysis for Business, Economics, and Policy<br>
<strong>Authors:</strong> Gábor Békés &amp; Gábor Kézdi<br>
<strong>Publisher:</strong> Cambridge University Press (2021)<br>
<strong>Interactive Edition:</strong> 2025</p>
<p><strong>Resources:</strong> - 📖 <a href="https://gabors-data-analysis.com">Main textbook site</a> - 💻 <a href="https://github.com/gabors-data-analysis/da_case_studies">Code repository</a> - 📊 <a href="https://osf.io/4vt9a/">Datasets</a> - 🎓 <a href="https://gabors-data-analysis.com/instructor-resources/">Instructor resources</a></p>
</section>
<hr>
<!-- 
File: index.qmd
Purpose: Main chapter index for Chapter 10
Version: 2.1 - Updated to reflect actual 4-page structure
Created: 2025-10-20
Last updated: 2025-10-20
Model: Claude Sonnet 4.5
Project: DA Textbook HTML Edition (Chapter 10 pilot)
Notes: Chapter 10 complete with 4 pages covering all sections 10.1-10.12
Structure: Foundation | Inference | Extensions | Applications
All 6 case studies included across the 4 pages
-->
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>